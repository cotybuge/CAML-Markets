fastapi
uvicorn
yfinance
services:
  - type: web
    name: caml-backend
    env: python
    plan: free
    buildCommand: ""
    startCommand: uvicorn main:app --host 0.0.0.0 --port 10000
    autoDeploy: true
from fastapi import FastAPI
from pydantic import BaseModel
import yfinance as yf

app = FastAPI()

class AnalyzeRequest(BaseModel):
    ticker: str
    history_days: int = 30

@app.post("/analyze")
def analyze_ticker(data: AnalyzeRequest):
    try:
        stock = yf.Ticker(data.ticker)
        hist = stock.history(period=f"{data.history_days}d")
        current_price = hist['Close'].iloc[-1]
        recent_trend = "up" if current_price > hist['Close'].mean() else "down"

        return {
            "ticker": data.ticker.upper(),
            "price": round(current_price, 2),
            "trend": recent_trend,
            "recommendation": "Buy" if recent_trend == "up" else "Hold",
            "reasoning": f"{data.ticker.upper()} is trending {recent_trend}.",
            "confidence": 91
        }
    except Exception as e:
        return {"error": str(e)}
